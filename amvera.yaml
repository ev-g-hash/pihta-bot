# Конфигурация для деплоя на Amvera Container
version: '1.0'

meta:
  name: telegram-pihta-bot
  description: "Многофункциональный Telegram-бот: погода, товары, недвижимость"
  version: "1.0.0"
  
toolchain:
  type: docker
  dockerfile: Dockerfile
  context: .

container:
  type: docker
  dockerfile: Dockerfile
  context: .
  tag: "telegram-pihta-bot:latest"
  
  environment:
    BOT_TOKEN: "${BOT_TOKEN}"
    WEATHER_API_KEY: "${WEATHER_API_KEY}"
    PYTHONDONTWRITEBYTECODE: "1"
    PYTHONUNBUFFERED: "1"
  
  command: ["python", "main.py"]
  
  healthcheck:
    enabled: true
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 40s

resources:
  memory:
    min: 256MB
    max: 512MB
  cpu:
    min: 0.25
    max: 0.5

scaling:
  auto_scaling: false
  replicas: 1

logging:
  level: INFO
  format: json
  output: stdout

variables:
  - name: BOT_TOKEN
    description: "Токен Telegram бота от @BotFather"
    required: true
    type: secret
  - name: WEATHER_API_KEY
    description: "API ключ Яндекс.Погоды"
    required: true
    type: secret